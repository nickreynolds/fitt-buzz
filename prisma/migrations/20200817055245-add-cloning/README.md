# Migration `20200817055245-add-cloning`

This migration has been generated by Nick Reynolds at 8/17/2020, 1:52:45 AM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
ALTER TABLE "public"."Routine" ADD COLUMN "cloneOfRoutineId" text   ;

ALTER TABLE "public"."Routine" ADD FOREIGN KEY ("cloneOfRoutineId")REFERENCES "public"."Routine"("id") ON DELETE SET NULL ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200817051904-change-created-by-name..20200817055245-add-cloning
--- datamodel.dml
+++ datamodel.dml
@@ -4,9 +4,9 @@
 ///
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url = "***"
 }
 model Exercise {
   createdAt     DateTime       @default(now())
@@ -41,15 +41,18 @@
   routineId   String?
 }
 model Routine {
-  createdAt   DateTime          @default(now())
-  createdById String?
-  id          String            @id
-  createdBy   User?             @relation(fields: [createdById], references: [id])
-  revisions   RoutineRevision[]
-  name        String
-  description String
+  createdAt        DateTime          @default(now())
+  createdById      String?
+  id               String            @id
+  createdBy        User?             @relation(fields: [createdById], references: [id])
+  revisions        RoutineRevision[]
+  name             String
+  description      String
+  cloneOf          Routine?          @relation("RoutineToRoutine", fields: [cloneOfRoutineId], references: [id])
+  clones           Routine[]         @relation("RoutineToRoutine")
+  cloneOfRoutineId String?
 }
 model Format {
   createdAt   DateTime     @default(now())
```


