# Migration `20200816151339-not-sure`

This migration has been generated by Nick Reynolds at 8/16/2020, 3:13:39 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "public"."_FormatToMeasurable" (
"A" text  NOT NULL ,"B" text  NOT NULL )

ALTER TABLE "public"."Exercise" DROP CONSTRAINT IF EXiSTS "Exercise_createdById_fkey",
ALTER COLUMN "createdById" DROP NOT NULL;

ALTER TABLE "public"."Measurable" DROP CONSTRAINT IF EXiSTS "Measurable_exerciseId_fkey",
DROP COLUMN "exerciseId";

CREATE UNIQUE INDEX "_FormatToMeasurable_AB_unique" ON "public"."_FormatToMeasurable"("A","B")

CREATE  INDEX "_FormatToMeasurable_B_index" ON "public"."_FormatToMeasurable"("B")

ALTER TABLE "public"."_FormatToMeasurable" ADD FOREIGN KEY ("A")REFERENCES "public"."Format"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."_FormatToMeasurable" ADD FOREIGN KEY ("B")REFERENCES "public"."Measurable"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."Exercise" ADD FOREIGN KEY ("createdById")REFERENCES "public"."User"("id") ON DELETE SET NULL  ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200816135428-relationship..20200816151339-not-sure
--- datamodel.dml
+++ datamodel.dml
@@ -1,8 +1,8 @@
 // 1
 datasource db {
     provider = "postgresql"
-    url = "***"
+    url = "***"
 }
 // 2
 generator client {
@@ -27,20 +27,20 @@
     exercises    Exercise[] @relation(references: [id])
 }
 model Measurable {
-    id         String    @id
-    name       String
-    Exercise   Exercise? @relation(fields: [exerciseId], references: [id])
-    exerciseId String?
+    id      String   @id
+    name    String
+    formats Format[] @relation(references: [id])
 }
 model Format {
-    id          String     @id
-    createdAt   DateTime   @default(now())
+    id          String       @id
+    createdAt   DateTime     @default(now())
     name        String
     description String
-    Exercise    Exercise[]
+    measurables Measurable[]
+    exercises   Exercise[]
 }
 model Exercise {
     id            String         @id
@@ -48,13 +48,12 @@
     name          String
     description   String
     format        Format         @relation(fields: [formatId], references: [id])
     muscleImpacts MuscleImpact[] @relation(references: [id])
-    createdBy     User           @relation(fields: [createdById], references: [id])
-    createdById   String
+    createdBy     User?          @relation(fields: [createdById], references: [id])
+    createdById   String?
     sets          Set[]
     formatId      String
-    measurables   Measurable[]
 }
 model Set {
     id          String     @id
```


