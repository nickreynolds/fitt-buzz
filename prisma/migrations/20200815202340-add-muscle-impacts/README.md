# Migration `20200815202340-add-muscle-impacts`

This migration has been generated by Nick Reynolds at 8/15/2020, 8:23:40 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "public"."Muscle" (
"createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,"description" text  NOT NULL ,"id" SERIAL,"name" text  NOT NULL ,
    PRIMARY KEY ("id"))

CREATE TABLE "public"."MuscleImpact" (
"id" SERIAL,"impactRating" integer  NOT NULL ,"muscleId" integer  NOT NULL ,
    PRIMARY KEY ("id"))

CREATE TABLE "public"."Format" (
"createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,"description" text  NOT NULL ,"id" SERIAL,"name" text  NOT NULL ,
    PRIMARY KEY ("id"))

CREATE TABLE "public"."_ExerciseToMuscleImpact" (
"A" integer  NOT NULL ,"B" integer  NOT NULL )

ALTER TABLE "public"."Exercise" DROP COLUMN "format",
ADD COLUMN "formatId" integer  NOT NULL ;

CREATE UNIQUE INDEX "_ExerciseToMuscleImpact_AB_unique" ON "public"."_ExerciseToMuscleImpact"("A","B")

CREATE  INDEX "_ExerciseToMuscleImpact_B_index" ON "public"."_ExerciseToMuscleImpact"("B")

ALTER TABLE "public"."MuscleImpact" ADD FOREIGN KEY ("muscleId")REFERENCES "public"."Muscle"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."_ExerciseToMuscleImpact" ADD FOREIGN KEY ("A")REFERENCES "public"."Exercise"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."_ExerciseToMuscleImpact" ADD FOREIGN KEY ("B")REFERENCES "public"."MuscleImpact"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."Exercise" ADD FOREIGN KEY ("formatId")REFERENCES "public"."Format"("id") ON DELETE CASCADE  ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200811224837-rename-posted-by..20200815202340-add-muscle-impacts
--- datamodel.dml
+++ datamodel.dml
@@ -1,8 +1,8 @@
 // 1
 datasource db {
     provider = "postgresql"
-    url = "***"
+    url = "***"
 }
 // 2
 generator client {
@@ -10,19 +10,45 @@
 }
 // 3
-model Exercise {
-    id          Int      @id @default(autoincrement())
-    createdAt   DateTime @default(now())
+model Muscle {
+    id           Int            @id @default(autoincrement())
+    createdAt    DateTime       @default(now())
+    name         String
+    description  String
+    MuscleImpact MuscleImpact[]
+}
+
+model MuscleImpact {
+    id           Int        @id @default(autoincrement())
+    muscle       Muscle     @relation(fields: [muscleId], references: [id])
+    impactRating Int
+    muscleId     Int
+    exercises    Exercise[]
+}
+
+model Format {
+    id          Int        @id @default(autoincrement())
+    createdAt   DateTime   @default(now())
     name        String
     description String
-    format      String
-    createdBy   User     @relation(fields: [createdById], references: [id])
-    createdById Int
-    sets        Set[]
+    Exercise    Exercise[]
 }
+model Exercise {
+    id            Int            @id @default(autoincrement())
+    createdAt     DateTime       @default(now())
+    name          String
+    description   String
+    format        Format         @relation(fields: [formatId], references: [id])
+    muscleImpacts MuscleImpact[]
+    createdBy     User           @relation(fields: [createdById], references: [id])
+    createdById   Int
+    sets          Set[]
+    formatId      Int
+}
+
 model Set {
     id          Int        @id @default(autoincrement())
     exercise    Exercise   @relation(fields: [exerciseId], references: [id])
     restSeconds Int
```


