# Migration `20200816135428-relationship`

This migration has been generated by Nick Reynolds at 8/16/2020, 1:54:28 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "public"."_ExerciseToMuscleImpact" (
"A" text  NOT NULL ,"B" text  NOT NULL )

ALTER TABLE "public"."MuscleImpact" DROP CONSTRAINT IF EXiSTS "MuscleImpact_exerciseId_fkey",
DROP COLUMN "exerciseId";

CREATE UNIQUE INDEX "_ExerciseToMuscleImpact_AB_unique" ON "public"."_ExerciseToMuscleImpact"("A","B")

CREATE  INDEX "_ExerciseToMuscleImpact_B_index" ON "public"."_ExerciseToMuscleImpact"("B")

ALTER TABLE "public"."_ExerciseToMuscleImpact" ADD FOREIGN KEY ("A")REFERENCES "public"."Exercise"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."_ExerciseToMuscleImpact" ADD FOREIGN KEY ("B")REFERENCES "public"."MuscleImpact"("id") ON DELETE CASCADE  ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200816133140-init..20200816135428-relationship
--- datamodel.dml
+++ datamodel.dml
@@ -1,8 +1,8 @@
 // 1
 datasource db {
     provider = "postgresql"
-    url = "***"
+    url = "***"
 }
 // 2
 generator client {
@@ -19,14 +19,13 @@
     MuscleImpact MuscleImpact[]
 }
 model MuscleImpact {
-    id           String    @id
-    muscle       Muscle    @relation(fields: [muscleId], references: [id])
+    id           String     @id
+    muscle       Muscle     @relation(fields: [muscleId], references: [id])
     impactRating Int
     muscleId     String
-    Exercise     Exercise? @relation(fields: [exerciseId], references: [id])
-    exerciseId   String?
+    exercises    Exercise[] @relation(references: [id])
 }
 model Measurable {
     id         String    @id
@@ -48,9 +47,9 @@
     createdAt     DateTime       @default(now())
     name          String
     description   String
     format        Format         @relation(fields: [formatId], references: [id])
-    muscleImpacts MuscleImpact[]
+    muscleImpacts MuscleImpact[] @relation(references: [id])
     createdBy     User           @relation(fields: [createdById], references: [id])
     createdById   String
     sets          Set[]
     formatId      String
```


